tcp_services = "{ ssh, domain, ntp }"
udp_services = "{ domain, 41641 }"

main_if = "em1"
tailscale_if = "tailscale0"

block all

# tailnet ACL rules are validated locally by tailscaled, skip pf
pass quick from $tailscale_if to any keep state

# allow only certain protocols initiated by the server 
pass out proto tcp to any port $tcp_services keep state
pass proto udp to any port $udp_services keep state

# allow only certain protocols initiated by a client
pass in inet proto tcp to $main_if port ssh
